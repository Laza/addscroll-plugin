// addScroll :: adding custom vertical scrollbar to layer
// http://lazaworx.com/addscroll-plugin/
(function(a){a.extend(a.support,{touch:"ontouchend"in document});var g=parseFloat(a.browser.version);vendor=a.browser.msie&&9>g&&"-ms-"||a.browser.webkit&&6>g&&"-webkit-"||a.browser.mozilla&&4>g&&"-moz-"||a.browser.opera&&10.5>g&&"-o-"||"";Math.minMax=function(b,d,c){return a.isNumeric(d)?d<b?b:d>c?c:d:b};a.fn.getBackground=function(){var b;a(this).each(function(){if("transparent"!==(b=a(this).css("background-color")))return!1});return b||"transparent"};a.extend(jQuery.easing,{easeOutBack:function(a,
d,c,h,m,i){null==i&&(i=1.70158);return h*((d=d/m-1)*d*((i+1)*d+i)+1)+c}});var k=["DOMMouseScroll","mousewheel"];if(a.event.fixHooks)for(g=k.length;g;)a.event.fixHooks[k[--g]]=a.event.mouseHooks;a.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var a=k.length;a;)this.addEventListener(k[--a],p,!1);else this.onmousewheel=p},teardown:function(){if(this.removeEventListener)for(var a=k.length;a;)this.removeEventListener(k[--a],p,!1);else this.onmousewheel=null}};a.fn.extend({mousewheel:function(a){return a?
this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}});var p=function(b){var d=b||window.event,c=[].slice.call(arguments,1),h=0,m=0,i=0,b=a.event.fix(d);b.type="mousewheel";d.wheelDelta?h=d.wheelDelta/120:d.detail&&(h=-d.detail/3);i=h;void 0!==d.axis&&d.axis===d.HORIZONTAL_AXIS&&(i=0,m=-1*h);void 0!==d.wheelDeltaY&&(i=d.wheelDeltaY/120);void 0!==d.wheelDeltaX&&(m=-1*d.wheelDeltaX/120);c.unshift(b,h,m,i);return(a.event.dispatch||a.event.handle).apply(this,
c)};a.fn.addScroll=function(b){b=a.extend({},a.fn.addScroll.defaults,b);css=a.fn.addScroll.css;return this.each(function(){var d,c=a(this),h=a(this).parent(),m,i,g,f,n,j,e,k,p=0,C,r,D,q,s,v;h.css({position:"relative"});c.css({position:"absolute",width:h.width()-20-b.gap});n=a("<div>").css(css.ctrls).appendTo(h);m=a("<div>").css(css.sup).appendTo(n);i=a("<div>").css(css.sdn).appendTo(n);g=a("<div>").css(css.sbar).appendTo(n);f=a("<div>").css(css.shan).appendTo(g);b.rounding&&n.add(f).css(vendor+"border-radius",
b.rounding+"px");b.shadows&&(n.css(vendor+"box-shadow","inset 1px 2px 5px rgba(0,0,0,0.5)"),f.css(vendor+"box-shadow","1px 2px 4px rgba(0,0,0,0.5)"));f.css("background-color",h.parents().getBackground());m.add(i).hover(function(){a(this).css({backgroundPosition:"-20px 0"})},function(){a(this).css({backgroundPosition:"0 0"})});var l=function(){return c.position().top},t=function(a){return Math.round((g.height()-6)*-(null==a?l():a)/j)+3},w=function(){return Math.max(Math.round((g.height()-6)*e/j),b.dragMinSize)},
x=function(a){null==a&&(a=l());m.css({opacity:a?1:b.disabledOpacity});i.css({opacity:a===e-j?b.disabledOpacity:1})},y=function(){return!1},z=function(){c.css({width:h.width()-20-b.gap});j=c.height();e=h.height();if(j<=e)c.css({top:0}).off("selectstart",y),n.hide();else{c.position().top<e-j&&c.css({top:e-j});f.css({top:t(),height:w()});if(b.enableDrag)c.on("selectstart",y);n.show();x()}},o=function(a){clearInterval(k);e>=j||(a=Math.minMax(e-j,a,0),f.stop(!0,!0).animate({top:t(a)},b.speed,b.effect),
c.stop(!0,!0).animate({top:a},b.speed,b.effect,function(){x(a)}))};m.click(function(){o(l()+e);return!1});i.click(function(){o(l()-e);return!1});g.click(function(a){a.pageY<f.offset().top?o(l()+e):a.pageY>f.offset().top+f.height()&&o(l()-e);return!1});var E=function(a){f.css({top:Math.minMax(2,Math.round(a.pageY-f.data("my")),g.height()-f.height()-2)});c.css({top:Math.minMax(e-j,-Math.round((f.position().top-3)*j/(g.height()-6)),0)});x();return!1},F=function(){a(document).off("mousemove",E).off("mouseup",
F);return!1};f.on("mousedown",function(H){a(this).data("my",Math.round(H.pageY)-a(this).position().top);a(document).on({mousemove:E,mouseup:F});return!1});b.enableMouseWheel&&c.mousewheel(function(a,c){c&&o(l()+b.wheelIncr*(0>c?-1:1));return!1});var u=function(a){return p=a.touches&&0<a.touches.length?a.touches[0].clientY:a.clientY?a.clientY:p},I=function(){s+=Math.round(q/20);var a=D+s;0<a||a<v?clearInterval(k):(c.css({top:a}),f.css({top:t(),height:w()}),q*=0.8,10>Math.abs(q)&&(q=0,clearInterval(k)))},
A=function(a){if(r){if(a=u(a)-r)c.data("dragOn",!0),c.css({top:Math.minMax(v,C+a,0)}),f.css({top:t(),height:w()})}else r=u(a);return!1},B=function(b){D=l();var b=u(b)-r,d=(new Date).getTime()-tT;q=1E3*b/d;k=setInterval(I,50);a.support.touch?this.ontouchend=this.ontouchmove=null:a(document).off({mousemove:A,mouseup:B});setTimeout(function(){c.data("dragOn",!1)},20);return 4>Math.abs(b)&&300>d},G=function(b){if(e>=j||("touchstart"===b.type||"touchmove"===b.type)&&(!b.touches||1<b.touches.length||c.is(":animated")))return!0;
clearInterval(k);te=b;C=l();r=u(b);tT=(new Date).getTime();s=0;v=e-j;if(a.support.touch)return a(b.target).closest("a").focus(),this.ontouchmove=A,this.ontouchend=B,!0;a(document).on({mousemove:A,mouseup:B});return!1};if(b.enableDrag)if(n.on("selectstart",y),a.support.touch)c[0].ontouchstart=G;else c.on("mousedown",G);a(window).resize(function(){clearTimeout(d);d=setTimeout(z,50)});d=setTimeout(z,10);c.attr("role","scroll").data("dragOn",!1).on("adjust",z);(a.isFunction(b.enableKeyboard)||b.enableKeyboard)&&
a(document).keydown(function(a){if(document.activeElement&&"INPUT"===document.activeElement.nodeName)return!0;switch(a?a.keyCode:window.event.keyCode){case 33:return o(l()+e),!1;case 34:return o(l()-e),!1}return!0})})};a.fn.addScroll.css={ctrls:{position:"absolute",right:0,top:0,bottom:0,width:"20px",backgroundColor:"rgba(0,0,0,0.25)"},sup:{position:"absolute",top:0,height:"20px",width:"100%",backgroundImage:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAUCAMAAADImI+JAAAAA3NCSVQICAjb4U/gAAAA21BMVEX////z8/Px8fHv7+/r6+vj4+Ph4eHd3d3V1dXT09PMzMz////39/fz8/Ph4eHf39/R0dHMzMz29vbr6+vj4+Pf39/V1dXR0dHMzMz7+/v4+Pjn5+fh4eHT09P////7+/v39/fz8/Px8fHv7+/n5+fl5eXb29vV1dXT09PPz8/z8/Pv7+/t7e3n5+fh4eHd3d3b29vX19fV1dXPz8/V1dXX19fz8/Px8fHr6+vf39/V1dXR0dH////7+/v4+Pj29vbz8/Px8fHv7+/r6+vl5eXh4eHf39/b29vZ2dkZVI+xAAAASXRSTlMAERERERERERERESIiIiIiIiIzMzMzMzMzRERERERVVVVVVVVVVVVVVVVmZmZmZmZmZmZmiJm7u7u7u7vMzMzMzMzMzMzMzMzMnYvVbwAAAAlwSFlzAAALEgAACxIB0t1+/AAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNXG14zYAAAAWdEVYdENyZWF0aW9uIFRpbWUAMDIvMjcvMTKZQM39AAAAsElEQVQokd3PVw6CQBCA4bGBgl0RUVnE3lGxyyp2738igYTgDjdgXib58+0mAxDFEcajDG7186kWcuZy3uOxez8OEnbGTNO6PHI3SvcSdsSZf+k5y2Kk58Rs25Gc30quUxoXRxaCxyvHAeQnhFT8Zn7uVAFo2hadBj8auujuvE5ifpNfV8XdLZuWmXNSqiowgU8Ct92kgUuwd8vrRRXQDL/PPm4gDDpx3IrHXS4EozA/q10U2ZOLzHEAAAAASUVORK5CYII=)",
backgroundRepeat:"no-repeat",backgroundPosition:"0 0"},sdn:{position:"absolute",bottom:0,height:"20px",width:"100%",backgroundImage:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAUCAMAAADImI+JAAAAA3NCSVQICAjb4U/gAAAAyVBMVEX////////x8fHt7e3h4eHPz8/MzMzHx8f19fXz8/Pd3d3b29vY2NjV1dXPz8/MzMz7+/vp6enl5eXh4eHd3d3b29vV1dXMzMz////7+/vz8/Pv7+/p6enb29vT09PR0dHPz8/MzMz39/f19fXx8fHt7e3p6enn5+fl5eXh4eHd3d3V1dXT09PR0dHPz8/MzMzz8/Pf39/7+/vx8fHV1dXT09PPz8/////7+/v39/f19fXx8fHv7+/r6+vp6enl5eXh4eHb29vV1dUeyeDsAAAAQ3RSTlMAERERERERESIiIiIiIiIiMzMzMzMzMzNVVVVVVVVVVVVVZmZmZmZmZmZmZmZmZmaqqru7u7u7zMzMzMzMzMzMzMzM6wrcmgAAAAlwSFlzAAALEgAACxIB0t1+/AAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNXG14zYAAAAWdEVYdENyZWF0aW9uIFRpbWUAMDIvMjcvMTKZQM39AAAAuElEQVQokd2OVw6CQBBABxULCpZVXMSCiigodmVxLeD9DyWQSFluwPxM8vIybwCKOLWDzbOsfb+KOXG43XRZpvnvcU7kJ6Myy6TTsZEB1fksSgjaNM4HWTncg1sqH2TXAoC4s4zen+399wsByF/vZSQXraWiCpJt6UopznoPQlHgUVJP2q0Vxqpp6phLWP9JCP18KOmkv6yoGC8WaQ8AUUJcN+sBNAMz60Wm4zBeaCocy9DlnPMKMT+D4hKAU0ohVAAAAABJRU5ErkJggg==)",
backgroundRepeat:"no-repeat",backgroundPosition:"0 0"},sbar:{position:"absolute",top:"20px",bottom:"20px",width:"100%"},shan:{position:"absolute",top:"3px",left:"3px",right:"3px",height:"10px",backgroundColor:"rgba(255,255,255,0.3)"}};a.fn.addScroll.defaults={enableKeyboard:!0,enableMouseWheel:!0,enableDrag:!0,dragMinSize:10,speed:250,effect:"easeOutBack",disabledOpacity:0.3,wheelIncr:50,rounding:10,gap:3,shadows:!0}})(jQuery);
